<!DOCTYPE html>
<html lang="de">
	<head>
	<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Home</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<link rel="stylesheet" href="Css.css">
	</head>
	<body>
		<header>
			<h1 class="startseiteH1">Animes</h1>
			<nav class="navigationBox schatten">
				<ul class="navigationList">
					<li class="navigationButton"><a href="Home.html" class="navigation">Startseite</a></li>
					<li class="navigationButton"><a href="Datenbank Uebersicht Anime.html" class="navigation">Animes</a></li>
					<li class="navigationButton"><a href="Datenbank Uebersicht Manga.html" class="navigation">Mangas</a></li>
					<li class="navigationButton"><a href="Registration.html" class="navigation">Registration</a></li>
					<li class="navigationButton"><a href="Login.html" class="navigation">Log in</a></li>
					<li><input type="text" id="suche" placeholder="Suche..." class="searchBar"></li>
				</ul>
			</nav>
		</header>
		<footer class="navigationBox2 schatten">
				<ul class="navigationList">
					<li class="navigationButton"><a href="Impressum.html" class="navigation">Impressum</a></li>
					<li class="navigationButton navigationButton2"><a href="Admin Ansicht.html" class="navigation">Admin Ansicht</a></li>
				</ul>
		</footer>
		<main>
			<form id="uploadForm" enctype="multipart/form-data">
				<article class="mainBox">
					<section class="filter">
						<label class="labelSpaceRight">Genre: </label>
						<select id="Genre" class="dropdownMenue" name="Genre" onchange="BrowseFilter()">
						</select>
						<label class="labelSpaceLeft labelSpaceRight">Season:</label>
						<select id="Season" class="dropdownMenue" name="Season" onchange="BrowseFilter()">
						</select>
						<label class="labelSpaceLeft labelSpaceRight">Jahr:</label>
						<select id="Jahr" class="dropdownMenue" name="Jahr" onchange="BrowseFilter()">
						</select>
						<label class="labelSpaceLeft labelSpaceRight">Format:</label>
						<select id="Format" class="dropdownMenue" name="Format" onchange="BrowseFilter()">
						</select>
						<label class="labelSpaceLeft labelSpaceRight">Source:</label>
						<select id="Source" class="dropdownMenue" name="Source" onchange="BrowseFilter()">
						</select>
						<!--
						<label class="labelSpaceLeft labelSpaceRight">:</label>
						<select id="select" class="dropdownMenue">
							<option value=""></option>
						</select>
						-->
					</section>
					<section class="genreAuswahlBox">
						<img src="Bilder\Genres\Action.png" class="genreAuswahl"></img>
						<img src="Bilder\Genres\Adventure.png" class="genreAuswahl"></img>
					</section>
				</article>
				<article class="mainBox datenbankBox" id="AnimeTablePlace">
					<footer class="navigationBox2 schatten">
						<ul class="navigationList">
							<li class="navigationButton"><a href="Home.html" class="navigation">Impressum</a></li>
							<li class="navigationButton navigationButton2"><a href="Admin Ansicht.html" class="navigation">Admin Ansicht</a></li>
						</ul>
					</footer>
				</article>
			<article class="hinterGrundBox" id="TransparentBox" onclick="HideEntry()">
			</article>
				<article class="eintragBox schatten" id="EintragInfoBox">
					<section class="eintragBildBox schatten">
						<image src="" width="215" height="300" id="Cover"></img>
					</section>
					<section class="eintragAuswahlBox">
						<select id="ListStatus" type="dropdownMenue" name="ListStatus">
							<option value="0">---</option>
						</select>
					</section>
					<section class="eintragLoeschen">
						<label>Delete</label>
					</section>
					<section class="eintragH1Box">
						<label id="Romaji"></label>
					</section>
					<section class="eintragInfoBox">
						<table class="eintragTable">
							<tr>
								<td class="eintragTableTD"><b><label>Englischer Titel:</label></b></td>
								<td><label id="Englisch"></label></td>
							</tr>
							<tr>
								<td><b><label>Deutscher Titel:</label></b></td>
								<td><label id="Deutsch"></label></td>
							</tr>
						</table>
						<table class="eintragTable eintragTable2">
							<tr>
								<td class="eintragTableTD"><b><label>Beschreibung:</label></b></td>
								<td><label id="Beschreibung">
								</label></td>
							</tr>
						</table>
						<table class="eintragTable2">
							<tr>
								<td class="eintragTableTD"><b><label>Folgen:</label></b></td>
								<td><label id="Folgen"></label></td>
							</tr>
							<tr>
								<td class="eintragTableTD"><b><label>Folgen l&auml;nge:</label></b></td>
								<td><label id="Dauer"></label>min</td>
							</tr>
						</table>
						<table class="eintragTable2">
							<tr>
								<td class="eintragTableTD"><b><label>Status:</label></b></td>
								<td><label id="Status"></label></td>
							</tr>
							<tr>
								<td class="eintragTableTD"><b><label>Season:</label></b></td>
								<td><label id="SeasonEintrag"></label></td>
							</tr>
							<tr>
								<td class="eintragTableTD"><b><label>Start:</label></b></td>
								<td><label id="StartDate"></label></td>
							</tr>
							<tr>
								<td class="eintragTableTD"><b><label>End:</label></b></td>
								<td><label id="EndDate"></label></td>
							</tr>
						</table>
						<table class="eintragTable2">
							<tr>
								<td class="eintragTableTD"><b><label>Format:</label></b></td>
								<td><label id="FormatEintrag"></label></td>
							</tr>
							<tr>
								<td class="eintragTableTD"><b><label>Source:</label></b></td>
								<td><label id="SourceEintrag"></label></td>
							</tr>
							<tr>
								<td class="eintragTableTD"><b><label>Studio:</label></b></td>
								<td><label id="StudioEintrag"></label></td>
							</tr>
							<tr>
								<td class="eintragTableTD"><b><label>Genres:</label></b></td>
								<td><label id="GenreEintrag"></label></td>
							</tr>
						</table>
					</section>
				</article>
			</form>
		</main>
		<script>
			
			$(document).ready(function() {
				LoadAndDisplayDropDownMenues()
			})

			function LoadAndDisplayDropDownMenues(){
				$.ajax({
					url: 'http://localhost:8000/api/genre/alle',
					method: 'get',
					contentType: 'application/json; charset=utf-8',
					cache: false,
					dataType: 'json',
				}).done(function (response) {
					console.log(response);
					RenderGenreOptions(response);                
				}).fail(function (jqXHR, statusText, error) {
					console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
					$('#output').html('Ein Fehler ist aufgetreten');
				})
				
				$.ajax({
					url: 'http://localhost:8000/api/season/alle',
					method: 'get',
					contentType: 'application/json; charset=utf-8',
					cache: false,
					dataType: 'json',
				}).done(function (response) {
					console.log(response);
					RenderSeasonOptions(response);                
				}).fail(function (jqXHR, statusText, error) {
					console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
					$('#output').html('Ein Fehler ist aufgetreten');
				})
				
				$.ajax({
					url: 'http://localhost:8000/api/jahr/alle',
					method: 'get',
					contentType: 'application/json; charset=utf-8',
					cache: false,
					dataType: 'json',
				}).done(function (response) {
					console.log(response);
					RenderJahrOptions(response);                
				}).fail(function (jqXHR, statusText, error) {
					console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
					$('#output').html('Ein Fehler ist aufgetreten');
				})
				
				$.ajax({
					url: 'http://localhost:8000/api/format/alle/Anime',
					method: 'get',
                	contentType: 'application/json; charset=utf-8',
                	cache: false,
                	dataType: 'json',
				}).done(function (response) {
                	console.log(response);
                	RenderFormatOptions(response);                
            	}).fail(function (jqXHR, statusText, error) {
                	console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
                	$('#output').html('Ein Fehler ist aufgetreten');
				})
				
				$.ajax({
					url: 'http://localhost:8000/api/source/alle',
					method: 'get',
					contentType: 'application/json; charset=utf-8',
					cache: false,
					dataType: 'json',
				}).done(function (response) {
					console.log(response);
					RenderSourceOptions(response);                
				}).fail(function (jqXHR, statusText, error) {
					console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
					$('#output').html('Ein Fehler ist aufgetreten');
				})
				
				$.ajax({
					url: 'http://localhost:8000/api/listStatus/alle/Anime',
					method: 'get',
					contentType: 'application/json; charset=utf-8',
					cache: false,
					dataType: 'json',
				}).done(function (response) {
					console.log(response);
					RenderStatusListStatus(response);
				}).fail(function (jqXHR, statusText, error) {
					console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
					$('#output').html('Ein Fehler ist aufgetreten');
				})
				
				$.ajax({
					url: 'http://localhost:8000/api/Anime/Alle',
					method: 'get',
					contentType: 'application/json; charset=utf-8',
					cache: false,
					dataType: 'json',
				}).done(function (response) {
					console.log(response);
					RenderAnimeTable(response);
				}).fail(function (jqXHR, statusText, error) {
					console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
					$('#output').html('Ein Fehler ist aufgetreten');
				})
			}

			function RenderGenreOptions(arr) {
				console.log(arr);
				var select = document.getElementById("Genre");

				for (var i = 0; i < arr.length; i++){
					var opt = document.createElement("option");
					opt.value = arr[i].id;
					opt.innerHTML = arr[i].genre;
					select.appendChild(opt);
				}
			}

			function RenderSeasonOptions(arr) {
				console.log(arr);
				var select = document.getElementById("Season");

				for (var i = 0; i < arr.length; i++){
					var opt = document.createElement("option");
					opt.value = arr[i].id;
					opt.innerHTML = arr[i].season;
					select.appendChild(opt);
				}
			}

			function RenderJahrOptions(arr) {
				console.log(arr);
				var select = document.getElementById("Jahr");

				for (var i = 0; i < arr.length; i++){
					var opt = document.createElement("option");
					opt.value = arr[i].id;
					opt.innerHTML = arr[i].jahr;
					select.appendChild(opt);
				}
			}

			function RenderFormatOptions(arr) {
				console.log(arr);
				var select = document.getElementById("Format");

				for (var i = 0; i < arr.length; i++){
					var opt = document.createElement("option");
					opt.value =  arr[i].id;
					opt.innerHTML = arr[i].format;
					select.appendChild(opt);
				}
			}
						
			function RenderSourceOptions(arr) {
				console.log(arr);
				var select = document.getElementById("Source");

				for (var i = 0; i <arr.length; i++){
					var opt = document.createElement("option");
					opt.value = arr[i].id;
					opt.innerHTML = arr[i].source;
					select.appendChild(opt);
				}
			}
			
			function RenderStatusListStatus(arr) {
				console.log(arr);
				var select = document.getElementById("ListStatus");

				for (var i = 0; i <arr.length; i++){
					var opt = document.createElement("option");
					opt.value = arr[i].id;
					opt.innerHTML = arr[i].ListStatus;
					select.appendChild(opt);
				}
			}

			function BrowseFilter(){

				var SelectedValueGenre = 1
				var SelectedValueSeason = 1
				var SelectedValueJahr = 1
				var SelectedValueFormat = 1
				var SelectedValueSource = 1

				SelectedValueGenre = document.getElementById('Genre').value
				SelectedValueSeason = document.getElementById('Season').value
				SelectedValueJahr = document.getElementById('Jahr').value
				SelectedValueFormat = document.getElementById('Format').value
				SelectedValueSource = document.getElementById('Source').value
				
				table = document.getElementById('AnimeAuswahl')
				table.parentNode.removeChild(table)

				$.ajax({
					url: 'http://localhost:8000/api/Fillter/SortGenre/'+ SelectedValueGenre + '_' + SelectedValueSeason + '_' + SelectedValueJahr + '_' + SelectedValueFormat + '_' + SelectedValueSource,
					method: 'get',
					contentType: 'application/json; charset=utf-8',
					cache: false,
					dataType: 'json',
				}).done(function (response) {
					console.log(response);
					RenderAnimeTable(response);          
				}).fail(function (jqXHR, statusText, error) {
					console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
					$('#output').html('Ein Fehler ist aufgetreten');
				})

			}

			function RenderAnimeTable(arr){
				
				var table = document.createElement("table");
				document.getElementById("AnimeTablePlace").appendChild(table).setAttribute("id", "AnimeAuswahl")
				document.getElementById("AnimeAuswahl").classList.add("pictureTable")
				var zaehler = 0;
				
				$(arr).each(function(idx, item){

					

					animeName = item.romaji;

					if(animeName.length > 30){
						animeName = animeName.substr(0,25) + '...'
					}

					if(zaehler == 7) {
						zaehler = 0;	
					}
					
					if(zaehler == 0){
						row = table.insertRow();
						A = row.insertCell();
						B = row.insertCell();
						C = row.insertCell();
						D = row.insertCell();
						E = row.insertCell();
						F = row.insertCell();
						zaehler += 1;
					}
					
					if(zaehler == 1) {
						A.innerHTML = '<image src="' + item.cover + '" width="215" height="300" onclick="ShowEntry(' + item.id + ')"><p><label onclick="ShowEntry(' + item.id + ')">' + animeName + '</label>';
						}
					if(zaehler == 2) {
						B.innerHTML = '<image src="' + item.cover + '" width="215" height="300" onclick="ShowEntry(' + item.id + ')"><p><label onclick="ShowEntry(' + item.id + ')">' + animeName + '</label>';
						}
					if(zaehler == 3) {
						C.innerHTML = '<image src="' + item.cover + '" width="215" height="300" onclick="ShowEntry(' + item.id + ')"><p><label onclick="ShowEntry(' + item.id + ')">' + animeName + '</label>';
						}
					if(zaehler == 4) {
						D.innerHTML = '<image src="' + item.cover + '" width="215" height="300" onclick="ShowEntry(' + item.id + ')"><p><label onclick="ShowEntry(' + item.id + ')">' + animeName + '</label>';
						}
					if(zaehler == 5) {
						E.innerHTML = '<image src="' + item.cover + '" width="215" height="300" onclick="ShowEntry(' + item.id + ')"><p><label onclick="ShowEntry(' + item.id + ')">' + animeName + '</label>';
						}
					if(zaehler == 6) {
						F.innerHTML = '<image src="' + item.cover + '" width="215" height="300" onclick="ShowEntry(' + item.id + ')"><p><label onclick="ShowEntry(' + item.id + ')">' + animeName + '</label>';
						}
					zaehler += 1;
				})
		}

		function ShowEntry(id){
				
			$.ajax({
				url: 'http://localhost:8000/api/Anime/gib/'+ id,
				method: 'get',
				contentType: 'application/json; charset=utf-8',
				cache: false,
				dataType: 'json',
			}).done(function (response) {
				console.log(response);
				FillTableWithData(response);          
			}).fail(function (jqXHR, statusText, error) {
				console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
				$('#output').html('Ein Fehler ist aufgetreten');
			})

			$.ajax({
				url: 'http://localhost:8000/api/animeEintragGenre/animeGenre/'+ id,
				method: 'get',
				contentType: 'application/json; charset=utf-8',
				cache: false,
				dataType: 'json',
			}).done(function (response) {
				console.log(response);
				FillGenreCell(response);          
			}).fail(function (jqXHR, statusText, error) {
				console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
				$('#output').html('Ein Fehler ist aufgetreten');
			})

			EintragInfoBox.style.visibility="visible"
			TransparentBox.style.visibility="visible"
		}

		function HideEntry(){
			
			EintragInfoBox.style.visibility="hidden"
			TransparentBox.style.visibility="hidden"
			
			document.getElementById('Romaji').innerHTML = ''
			document.getElementById('Englisch').innerHTML = ''
			document.getElementById('Deutsch').innerHTML = ''
			document.getElementById('Beschreibung').innerHTML = ''
			document.getElementById('Folgen').innerHTML = ''
			document.getElementById('Dauer').innerHTML = ''
			document.getElementById('Status').innerHTML = ''
			document.getElementById('StartDate').innerHTML = ''
			document.getElementById('EndDate').innerHTML = ''
			document.getElementById('FormatEintrag').innerHTML = ''
			document.getElementById('SeasonEintrag').innerHTML = ''
			document.getElementById('StudioEintrag').innerHTML = ''
			document.getElementById('SourceEintrag').innerHTML = ''
			document.getElementById('Cover').src = ''
			document.getElementById('GenreEintrag').innerHTML = ''
		}

		function FillTableWithData(item) {

			document.getElementById('Romaji').innerHTML = item.romaji
			document.getElementById('Englisch').innerHTML = item.englisch
			document.getElementById('Deutsch').innerHTML = item.deutsch
			document.getElementById('Beschreibung').innerHTML = item.beschreibung
			document.getElementById('Folgen').innerHTML = item.folgenanzahl
			document.getElementById('Dauer').innerHTML = item.dauer
			document.getElementById('Status').innerHTML = item.status
			document.getElementById('StartDate').innerHTML = item.startdatum
			document.getElementById('EndDate').innerHTML = item.enddatum
			document.getElementById('FormatEintrag').innerHTML = item.format
			document.getElementById('SeasonEintrag').innerHTML = item.season + ' ' + item.jahr
			document.getElementById('StudioEintrag').innerHTML = item.studio
			document.getElementById('SourceEintrag').innerHTML = item.source
			document.getElementById('Cover').src = item.cover
		}

		function FillGenreCell(arr){

			var genres = ''

			$(arr).each(function(idx, item){

				genres += item.genre + ', '
			})

			genres = genres.substring(0, genres.length - 2)
			document.getElementById('GenreEintrag').innerHTML = genres
		}

/*  onmouseover="ShowFullName(' + item.id + ')
		function ShowFullName(id){

			var box = createElement('article')
		} */



		</script>
	</body>
</html>